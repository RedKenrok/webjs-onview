function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var t=["data-onview","data-onview-enter","data-onview-enter-add","data-onview-enter-remove","data-onview-enter-toggle","data-onview-exit","data-onview-exit-add","data-onview-exit-remove","data-onview-exit-toggle"];function n(e,t){return Object.keys(t).forEach((function(n){e[n]=t[n]})),e}function i(e,t){var n,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:",";Array.prototype.forEach.call(t.split(o),(function(t){switch((t=t.trim())[0]){case"#":t=t.substring(1).replace(" ","-"),e.id=t;break;case".":t=t.substring(1).replace(" ","-"),e.classList.contains(t)||e.classList.add(t);break;case"[":n=t.substring(1,t.indexOf("=")),i=t.substring(n.length+2,t.length-1),n=n.replace(" ","-"),e.setAttribute(n,i)}}))}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"context";return Function('"use strict"; return (function('+n+") { "+e+" });")()(t)}function r(e,t){var n,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:",";Array.prototype.forEach.call(t.split(o),(function(t){switch((t=t.trim())[0]){case"#":t=t.substring(1).replace(" ","-"),e.removeAttribute(t);break;case".":t=t.substring(1).replace(" ","-"),e.classList.contains(t)&&e.classList.remove(t);break;case"[":(n=t.indexOf("="))<0&&(n=t.length-1),i=(i=t.substring(1,n)).replace(" ","-"),e.removeAttribute(i)}}))}function a(e,n,i){e.dataset.onviewRepeat||(e.removeAttribute(i),t.filter((function(t){return e.hasAttribute(t)})).length>0||(e.removeAttribute("data-onview-isintersecting"),n.unobserve(e)))}function s(e,t,n){t.forEach((function(t){e._options.debug&&console.log("OnView: Intersection change triggered for: ",t);var s=e._options.selectorSplitCharacter,c=t.target,u="true"===c.dataset.onviewIsintersecting!==t.isIntersecting;c.dataset.onviewIsintersecting=t.isIntersecting.toString();var v=[];if(c.dataset.onview&&c.dataset.onview.length>0){var d=c.dataset.onview;v.push((function(){return o(d,{entry:t},e._options.eventContextName)}))}if(t.isIntersecting){if(c.dataset.onviewEnter){var l=c.dataset.onviewEnter;v.push((function(){return o(l,{entry:t},e._options.eventContextName)})),a(c,n,"data-onview-enter")}if(c.dataset.onviewEnterAdd){var f=c.dataset.onviewEnterAdd;v.push((function(){return i(c,f,s)})),a(c,n,"data-onview-enter-add")}if(c.dataset.onviewEnterRemove){var h=c.dataset.onviewEnterRemove;v.push((function(){return r(c,h,s)})),a(c,n,"data-onview-enter-remove")}}if(c.dataset.onviewEnterToggle)if(t.isIntersecting){var p=c.dataset.onviewEnterToggle;v.push((function(){return i(c,p,s)}))}else if(u){var g=c.dataset.onviewEnterToggle;v.push((function(){return r(c,g,s)}))}if(u&&!t.isIntersecting){if(c.dataset.onviewExit){var w=c.dataset.onviewExit;v.push((function(){return o(w,{entry:t},e._options.eventContextName)})),a(c,n,"data-onview-exit")}if(c.dataset.onviewExitAdd){var b=c.dataset.onviewExitAdd;v.push((function(){return i(c,b,s)})),a(c,n,"data-onview-exit-add")}if(c.dataset.onviewExitRemove){var m=c.dataset.onviewExitRemove;v.push((function(){return r(c,m,s)})),a(c,n,"data-onview-exit-remove")}}if(c.dataset.onviewExitToggle)if(t.isIntersecting){var E=c.dataset.onviewExitToggle;v.push((function(){return r(c,E,s)}))}else if(u){var _=c.dataset.onviewExitToggle;v.push((function(){return i(c,_,s)}))}!function(e,t){if(!(e.length<=0))if(t){var n=parseInt(t,10);n<=0?e.forEach((function(e){e()})):setTimeout((function(){e.forEach((function(e){e()}))}),n)}else e.forEach((function(e){e()}))}(v,c.dataset.onviewDelay),"function"==typeof window.CustomEvent&&c.dispatchEvent(new CustomEvent("onview-change",{detail:{entry:t}}))}))}var c=function(){function i(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this._initialized=!1,this._options={debug:!1,readyState:i.READY_STATES.complete,observedElement:document.body,observerElement:null,observerMargin:"0px",eventContextName:"detail",selectorSplitCharacter:"?"},e&&e!=={}&&(this._options=n(this._options,e),this._options.debug&&console.log("OnView: overwriting options, new options:",this._options)),this._options.readyState===i.READY_STATES.interactive?"interactive"===document.readyState||"complete"===document.readyState?this.initialize():document.addEventListener("DOMContentLoaded",(function(){t.initialize()})):this._options.readyState===i.READY_STATES.complete&&("complete"===document.readyState?this.initialize():window.addEventListener("load",(function(){t.initialize()})))}var o,r,a;return o=i,(r=[{key:"getOptions",value:function(){return n({},this._options)}},{key:"isInitialized",value:function(){return this._initialized}},{key:"initialize",value:function(){this._initialized?this._options.debug&&console.warn("OnView: module instance already initialized, therefore re-initialization is ignored."):(this._initialized=!0,function(e){e._observer&&e._observer.disconnect();var t=n({threshold:0},{root:e._options.observerElement,rootMargin:e._options.observerMargin});e._observer=new IntersectionObserver((function(t,n){s(e,t,n)}),t)}(this),this.queryDocument(),this._options.debug&&console.log("OnView: module instance initialized."))}},{key:"destroy",value:function(){this._observer&&this._observer.disconnect(),this._observer=null,this._initialized=!1,this._options=null}},{key:"queryDocument",value:function(){var e=this,n=this._observer.takeRecords().map((function(e){return e.target})),i=t.map((function(e){return"["+e+"]"})),o=this._options.observedElement.querySelectorAll(i.join(","));n.length>0?Array.prototype.forEach.call(o,(function(t){n.indexOf(t)>=0||e._observer.observe(t)})):Array.prototype.forEach.call(o,(function(t){e._observer.observe(t)})),this._options.debug&&console.log("OnView: queried document for elements, observered elements: ",o)}}])&&e(o.prototype,r),a&&e(o,a),i}();c.READY_STATES={complete:"complete",interactive:"interactive",never:"never"};export default c;
